
SELECT *
FROM Ordenes;


INSERT INTO Ordenes (ClientesId, EmpleadosId, SucursalId, MensajerosId, TipoPagoId, OrigenId, HorarioVenta, TotalCompra, KilometrosRecorrer, FechaDespacho, FechaEntrega, FechaOrdenTomada, FechaOrdenLista) VALUES
(3, 7, 1, 8, 5, 1, 'Mañana', 1053.51, 5.5, '2023-01-10 08:30:00', '2023-01-10 09:00:00', '2023-01-10 08:00:00', '2023-01-10 08:15:00'),
(6, 4, 8, 2, 9, 2, 'Tarde', 1075.00, 10.0, '2023-02-15 14:30:00', '2023-02-15 15:00:00', '2023-02-15 13:30:00', '2023-02-15 14:00:00'),
(9, 5, 2, 4, 6, 3, 'Noche', 920.00, 2.0, '2023-03-20 19:30:00', '2023-03-20 20:00:00', '2023-03-20 19:00:00', '2023-03-20 19:15:00'),
(7, 10, 3, 9, 7, 4, 'Mañana', 930.00, 0.5, '2023-04-25 09:30:00', '2023-04-25 10:00:00', '2023-04-25 09:00:00', '2023-04-25 09:15:00'),
(5, 3, 4, 10, 2, 5, 'Tarde', 955.00, 8.0, '2023-05-30 15:30:00', '2023-05-30 16:00:00', '2023-05-30 15:00:00', '2023-05-30 15:15:00'),
(2, 8, 7, 5, 3, 1, 'Noche', 945.00, 12.5, '2023-06-05 20:30:00', '2023-06-05 21:00:00', '2023-06-05 20:00:00', '2023-06-05 20:15:00'),
(4, 6, 9, 7, 1, 2, 'Mañana', 1065.00, 7.5, '2023-07-10 08:30:00', '2023-07-10 09:00:00', '2023-07-10 08:00:00', '2023-07-10 08:15:00'),
(8, 1, 10, 3, 8, 3, 'Tarde', 1085.00, 9.5, '2023-08-15 14:30:00', '2023-08-15 15:00:00', '2023-08-15 14:00:00', '2023-08-15 14:15:00'),
(10, 2, 6, 1, 10, 4, 'Noche', 1095.00, 3.0, '2023-09-20 19:30:00', '2023-09-20 20:00:00', '2023-09-20 19:00:00', '2023-09-20 19:15:00'),
(1, 9, 5, 6, 4, 5, 'Mañana', 900.00, 15.0, '2023-10-25 09:30:00', '2023-10-25 10:00:00', '2023-10-25 09:00:00', '2023-10-25 09:15:00'),
(3, 7, 2, 4, 8, 6, 'Tarde', 1025.00, 5.5, '2023-11-01 14:30:00', '2023-11-01 15:00:00', '2023-11-01 14:00:00', '2023-11-01 14:15:00'),
(5, 1, 10, 9, 6, 7, 'Noche', 975.00, 7.0, '2023-11-02 19:30:00', '2023-11-02 20:00:00', '2023-11-02 19:00:00', '2023-11-02 19:15:00'),
(8, 6, 4, 5, 3, 8, 'Mañana', 990.00, 6.5, '2023-11-03 08:30:00', '2023-11-03 09:00:00', '2023-11-03 08:00:00', '2023-11-03 08:15:00'),
(7, 10, 3, 6, 1, 9, 'Tarde', 1035.00, 4.0, '2023-11-04 14:30:00', '2023-11-04 15:00:00', '2023-11-04 14:00:00', '2023-11-04 14:15:00'),
(4, 5, 8, 3, 10, 10, 'Noche', 1090.00, 12.5, '2023-11-05 19:30:00', '2023-11-05 20:00:00', '2023-11-05 19:00:00', '2023-11-05 19:15:00'),
(6, 3, 9, 2, 7, 1, 'Mañana', 950.00, 5.0, '2023-11-06 09:30:00', '2023-11-06 10:00:00', '2023-11-06 09:00:00', '2023-11-06 09:15:00'),
(9, 8, 5, 7, 4, 2, 'Tarde', 1100.00, 10.0, '2023-11-07 15:30:00', '2023-11-07 16:00:00', '2023-11-07 15:00:00', '2023-11-07 15:15:00'),
(2, 2, 1, 4, 2, 3, 'Noche', 1025.00, 3.0, '2023-11-08 20:30:00', '2023-11-08 21:00:00', '2023-11-08 20:00:00', '2023-11-08 20:15:00'),
(8, 4, 6, 10, 5, 4, 'Mañana', 1030.00, 8.0, '2023-11-09 08:30:00', '2023-11-09 09:00:00', '2023-11-09 08:00:00', '2023-11-09 08:15:00'),
(3, 10, 3, 1, 7, 5, 'Tarde', 1000.00, 2.5, '2023-11-10 14:30:00', '2023-11-10 15:00:00', '2023-11-10 14:00:00', '2023-11-10 14:15:00'),
(7, 6, 2, 5, 8, 6, 'Noche', 1090.00, 9.0, '2023-11-11 19:30:00', '2023-11-11 20:00:00', '2023-11-11 19:00:00', '2023-11-11 19:15:00'),
(1, 1, 4, 6, 3, 7, 'Mañana', 1015.00, 10.0, '2023-11-12 09:30:00', '2023-11-12 10:00:00', '2023-11-12 09:00:00', '2023-11-12 09:15:00'),
(5, 9, 5, 2, 9, 8, 'Tarde', 1050.00, 6.5, '2023-11-13 14:30:00', '2023-11-13 15:00:00', '2023-11-13 14:00:00', '2023-11-13 14:15:00'),
(4, 2, 1, 3, 6, 9, 'Noche', 970.00, 4.0, '2023-11-14 19:30:00', '2023-11-14 20:00:00', '2023-11-14 19:00:00', '2023-11-14 19:15:00'),
(6, 7, 8, 9, 10, 10, 'Mañana', 1100.00, 9.5, '2023-11-15 08:30:00', '2023-11-15 09:00:00', '2023-11-15 08:00:00', '2023-11-15 08:15:00'),
(2, 3, 2, 1, 7, 1, 'Tarde', 975.00, 2.0, '2023-11-16 14:30:00', '2023-11-16 15:00:00', '2023-11-16 14:00:00', '2023-11-16 14:15:00'),
(9, 10, 9, 4, 4, 2, 'Noche', 1005.00, 7.5, '2023-11-17 20:30:00', '2023-11-17 21:00:00', '2023-11-17 20:00:00', '2023-11-17 20:15:00'),
(8, 5, 7, 7, 8, 3, 'Mañana', 995.00, 12.5, '2023-11-18 09:30:00', '2023-11-18 10:00:00', '2023-11-18 09:00:00', '2023-11-18 09:15:00'),
(1, 1, 3, 2, 10, 4, 'Tarde', 1000.00, 6.0, '2023-11-19 14:30:00', '2023-11-19 15:00:00', '2023-11-19 14:00:00', '2023-11-19 14:15:00'),
(3, 6, 2, 10, 2, 5, 'Noche', 1050.00, 8.0, '2023-11-20 19:30:00', '2023-11-20 20:00:00', '2023-11-20 19:00:00', '2023-11-20 19:15:00'),
(7, 9, 1, 9, 5, 6, 'Mañana', 965.00, 4.0, '2023-11-21 08:30:00', '2023-11-21 09:00:00', '2023-11-21 08:00:00', '2023-11-21 08:15:00'),
(5, 8, 4, 6, 6, 7, 'Tarde', 1005.00, 9.5, '2023-11-22 14:30:00', '2023-11-22 15:00:00', '2023-11-22 14:00:00', '2023-11-22 14:15:00'),
(10, 2, 7, 5, 3, 8, 'Noche', 1025.00, 3.5, '2023-11-23 20:30:00', '2023-11-23 21:00:00', '2023-11-23 20:00:00', '2023-11-23 20:15:00'),
(6, 4, 6, 8, 1, 9, 'Mañana', 1040.00, 11.0, '2023-11-24 09:30:00', '2023-11-24 10:00:00', '2023-11-24 09:00:00', '2023-11-24 09:15:00'),
(4, 10, 5, 1, 8, 10, 'Tarde', 1095.00, 6.0, '2023-11-25 15:30:00', '2023-11-25 16:00:00', '2023-11-25 15:00:00', '2023-11-25 15:15:00'),
(8, 7, 3, 2, 7, 1, 'Noche', 1015.00, 12.5, '2023-11-26 19:30:00', '2023-11-26 20:00:00', '2023-11-26 19:00:00', '2023-11-26 19:15:00'),
(1, 5, 1, 10, 5, 2, 'Mañana', 980.00, 7.5, '2023-11-27 09:30:00', '2023-11-27 10:00:00', '2023-11-27 09:00:00', '2023-11-27 09:15:00'),
(9, 2, 9, 6, 4, 3, 'Tarde', 1025.00, 10.0, '2023-11-28 15:30:00', '2023-11-28 16:00:00', '2023-11-28 15:00:00', '2023-11-28 15:15:00'),
(5, 4, 10, 7, 9, 4, 'Noche', 1000.00, 3.0, '2023-11-29 20:30:00', '2023-11-29 21:00:00', '2023-11-29 20:00:00', '2023-11-29 20:15:00'),
(7, 3, 6, 3, 10, 5, 'Mañana', 990.00, 12.0, '2023-11-30 08:30:00', '2023-11-30 09:00:00', '2023-11-30 08:00:00', '2023-11-30 08:15:00'),
(2, 1, 7, 1, 3, 6, 'Tarde', 1065.00, 5.0, '2023-12-01 14:30:00', '2023-12-01 15:00:00', '2023-12-01 14:00:00', '2023-12-01 14:15:00'),
(4, 6, 8, 9, 1, 7, 'Noche', 1085.00, 8.5, '2023-12-02 20:30:00', '2023-12-02 21:00:00', '2023-12-02 20:00:00', '2023-12-02 20:15:00'),
(6, 8, 2, 8, 6, 8, 'Mañana', 1010.00, 9.0, '2023-12-03 09:30:00', '2023-12-03 10:00:00', '2023-12-03 09:00:00', '2023-12-03 09:15:00'),
(9, 7, 4, 7, 5, 9, 'Tarde', 1095.00, 6.5, '2023-12-04 14:30:00', '2023-12-04 15:00:00', '2023-12-04 14:00:00', '2023-12-04 14:15:00'),
(1, 10, 5, 5, 9, 10, 'Noche', 1055.00, 11.0, '2023-12-05 19:30:00', '2023-12-05 20:00:00', '2023-12-05 19:00:00', '2023-12-05 19:15:00'),
(3, 3, 10, 2, 4, 1, 'Mañana', 975.00, 8.0, '2023-12-06 08:30:00', '2023-12-06 09:00:00', '2023-12-06 08:00:00', '2023-12-06 08:15:00'),
(10, 2, 9, 9, 2, 2, 'Tarde', 1010.00, 5.5, '2023-12-07 14:30:00', '2023-12-07 15:00:00', '2023-12-07 14:00:00', '2023-12-07 14:15:00'),
(8, 1, 8, 4, 10, 3, 'Noche', 1005.00, 2.5, '2023-12-08 19:30:00', '2023-12-08 20:00:00', '2023-12-08 19:00:00', '2023-12-08 19:15:00'),
(7, 4, 1, 6, 7, 4, 'Mañana', 1090.00, 15.0, '2023-12-09 09:30:00', '2023-12-09 10:00:00', '2023-12-09 09:00:00', '2023-12-09 09:15:00'),
(5, 5, 3, 1, 8, 5, 'Tarde', 950.00, 12.5, '2023-12-10 14:30:00', '2023-12-10 15:00:00', '2023-12-10 14:00:00', '2023-12-10 14:15:00'),
(2, 9, 2, 7, 1, 6, 'Noche', 920.00, 7.0, '2023-12-11 19:30:00', '2023-12-11 20:00:00', '2023-12-11 19:00:00', '2023-12-11 19:15:00');


SELECT E.Nombre,
        CAST(AVG(TotalCompra) AS decimal(10, 2)) AS VolumenVentaPromedio,
        COUNT(*) AS CantidadVentas,
        MIN(TotalCompra) AS CompraMinima,
        MAX(TotalCompra) AS CompraMaxima
FROM Ordenes O
LEFT JOIN Empleados E
    ON O.EmpleadosId = E.EmpleadosId
GROUP BY E.Nombre
ORDER BY VolumenVentaPromedio DESC;

